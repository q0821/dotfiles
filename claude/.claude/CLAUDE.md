- 中文字元和英文字元之間，請加上一個半形空白字元，以方便閱讀。
- 不要誇我，驗證過是對就去做、有疑慮就問，不要浪費時間誇我。
- 生成 git commit 的訊息的時候，絕對不要加上 claude 相關的訊息
- Ask me any clarifying questions you need to.
- Always use context7 when I need code generation, setup or configuration steps, or
library/API documentation. This means you should automatically use the Context7 MCP
tools to resolve library id and get library docs without me having to explicitly ask.

# 核心開發原則

## 哲學

### 核心信念

- **漸進式進展 > 大爆炸式改寫** - 小改動可編譯、可測試
- **從現有代碼學習** - 先研究、規劃，再實作
- **務實 > 教條** - 適應專案實際狀況
- **清晰意圖 > 聰明技巧** - 選擇無聊且明顯的解法

### 簡單的定義

- 單一職責（一個函數/類別做一件事）
- 避免過早抽象化
- 不要玩聰明技巧 - 選擇無聊的解法
- 如果需要解釋，就是太複雜了

## 工作流程

### 1. 規劃與分階段

將複雜工作分成 3-5 個階段，記錄在 `IMPLEMENTATION_PLAN.md`：

```markdown
## 階段 N: [名稱]
**目標**: [具體交付物]
**成功標準**: [可測試的結果]
**測試**: [具體測試案例]
**狀態**: [未開始|進行中|完成]
```

- 進展時更新狀態
- 所有階段完成後刪除檔案

### 2. 實作流程

1. **理解** - 研究專案中現有的模式
2. **測試** - 先寫測試（紅燈）
3. **實作** - 最少代碼讓測試通過（綠燈）
4. **重構** - 在測試通過狀態下清理代碼
5. **提交** - 清楚的 commit 訊息，連結到計劃

### 3. 遇到問題時（最多 3 次嘗試）

**關鍵原則**：每個問題最多嘗試 3 次，然後停下來。

1. **記錄失敗內容**：
   - 嘗試了什麼
   - 具體錯誤訊息
   - 為什麼認為失敗

2. **研究替代方案**：
   - 找 2-3 個類似的實作
   - 注意使用的不同方法

3. **質疑基本假設**：
   - 這是正確的抽象層級嗎？
   - 能否拆分成更小的問題？
   - 有沒有完全更簡單的方法？

4. **嘗試不同角度**：
   - 不同的函式庫/框架功能？
   - 不同的架構模式？
   - 移除抽象而非增加抽象？

## 技術標準

### 架構原則

- **組合 > 繼承** - 使用依賴注入
- **明確 > 隱含** - 清楚的資料流和依賴關係
- **盡可能測試驅動** - 永遠不要停用測試，要修正它們

### 代碼品質

- **每次提交必須**：
  - 能成功編譯
  - 通過所有現有測試
  - 包含新功能的測試
  - 遵循專案格式化/檢查規範

- **提交前**：
  - 執行格式化工具/檢查工具
  - 自我檢視變更
  - 確保 commit 訊息解釋「為什麼」

### 錯誤處理

- 快速失敗，附上描述性訊息
- 包含除錯用的上下文資訊
- 在適當層級處理錯誤
- 永遠不要默默吞掉例外

## 決策框架

當有多種有效方法時，根據以下優先順序選擇：

1. **可測試性** - 我能輕易測試這個嗎？
2. **可讀性** - 六個月後有人能看懂嗎？
3. **一致性** - 符合專案模式嗎？
4. **簡單性** - 這是能運作的最簡單解法嗎？
5. **可逆性** - 之後要改有多難？

## 專案整合

### 學習代碼庫

- 找 3 個類似的功能/元件
- 辨識共同模式和慣例
- 盡可能使用相同的函式庫/工具
- 遵循現有的測試模式

### 工具

- 使用專案現有的建置系統
- 使用專案的測試框架
- 使用專案的格式化/檢查設定
- 沒有強烈理由不要引入新工具

## 品質關卡

### 完成定義（Definition of Done）

- [ ] 測試已寫好並通過
- [ ] 代碼遵循專案慣例
- [ ] 沒有檢查工具/格式化警告
- [ ] Commit 訊息清楚
- [ ] 實作符合計劃
- [ ] 沒有未連結 issue 編號的 TODO

### 測試指導

- 測試行為，不是實作
- 盡可能一個測試一個斷言
- 清楚的測試名稱描述場景
- 使用現有的測試工具/幫手
- 測試應該是確定性的（可重現）

## 重要提醒

**絕對不要**：
- 使用 `--no-verify` 繞過 commit hooks
- 停用測試而不是修正它們
- 提交無法編譯的代碼
- 做假設 - 用現有代碼驗證

**永遠要**：
- 漸進式提交可運作的代碼
- 進展時更新計劃文件
- 從現有實作學習
- 3 次失敗嘗試後停下來重新評估

---

## 使用說明

這是通用核心原則。根據專案類型，搭配讀取：

- **技術棧**：`tech-stacks/wordpress.md`、`tech-stacks/joomla.md` 等
- **專案類型**：`project-types/client-projects.md`、`project-types/government-contracts.md` 等
- **專業領域**：`specialized/security.md`、`specialized/multilingual.md` 等
